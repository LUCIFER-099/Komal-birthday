<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday Komal üéÇüíñ</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-dark:#0b0b12;
      --bg-light:#fff7f9;
      --accent:#ff6b9a;
      --soft:#ffd7e4;
      --text-dark:#111;
      --text-light:#fff;
    }
    html,body{height:100%; margin:0; font-family:'Poppins',system-ui,Arial; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; background:var(--bg-dark); color:var(--text-light);}

    /* Container and pages */
    .wrap{height:100vh; width:100%; position:relative; overflow:hidden; display:flex; align-items:center; justify-content:center;}
    .page{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; text-align:center; padding:24px; opacity:0; pointer-events:none; transition:opacity .9s ease; flex-direction:column;}
    .page.active{opacity:1; pointer-events:auto;}

    /* Background decoration layers */
    .bg-layer{position:absolute; inset:0; z-index:0; pointer-events:none;}
    /* twinkle stars */
    .star{position:absolute; width:2px; height:2px; background:rgba(255,255,255,.9); border-radius:50%; animation:twinkle 3.5s infinite ease-in-out; opacity:0;}
    @keyframes twinkle{0%,100%{opacity:0} 50%{opacity:1; transform:scale(1.6)}}

    /* floating hearts */
    .hearts{position:absolute; inset:0; z-index:1; pointer-events:none; overflow:hidden;}
    .heart{
      position:absolute; width:28px; height:28px; transform:translateY(120vh) scale(0.7);
      background:linear-gradient(45deg,#ff9cb1,#ff6b9a);
      clip-path: path('M24 4c2 0 4 2 4 4 0 7-8 11-12 16-4-5-12-9-12-16 0-2 2-4 4-4 3 0 3 2 4 2 1 0 1-2 4-2z');
      opacity:.9; border-radius:50%;
      animation:floatUp linear infinite;
    }
    /* fallback heart shape using transform: rotate */
    .heart::before,.heart::after{content:""; position:absolute; width:14px; height:14px; background:inherit; border-radius:50%;}
    .heart::before{left:7px; top:-7px;}
    .heart::after{left:-7px; top:-7px; transform:rotate(-25deg);}

    @keyframes floatUp{
      0%{transform:translateY(120vh) scale(.6) rotate(0); opacity:0}
      10%{opacity:1}
      100%{transform:translateY(-30vh) scale(1.1) rotate(360deg); opacity:0}
    }

    /* content styles */
    h1.main {font-family:'Dancing Script', cursive; font-size:clamp(28px,6vw,64px); margin:0 0 12px; letter-spacing:1px; text-shadow:0 6px 24px rgba(255,107,154,.12);}
    p.lead{font-size:clamp(14px,2.5vw,20px); margin:0 0 18px; color:rgba(255,255,255,.92); max-width:900px;}

    .btn {display:inline-block; padding:12px 20px; border-radius:999px; background:linear-gradient(90deg,#ff8bb1,#ff6b9a); color:white; font-weight:600; border:none; cursor:pointer; box-shadow:0 8px 30px rgba(0,0,0,.25); text-decoration:none;}
    .btn.secondary{background:transparent; border:2px solid rgba(255,255,255,.14);}

    /* blurred-photo background on page 4 */
    .photo-bg{position:absolute; inset:0; z-index:-1; background-size:cover; background-position:center; filter:blur(8px) brightness(.6) saturate(1.1); transform:scale(1.06);}

    /* small typing effect */
    .type {display:inline-block; border-right:2px solid rgba(255,255,255,.85); padding-right:6px; white-space:nowrap; overflow:hidden; vertical-align:middle;}

    /* theme (light) */
    .light-mode{--bg:var(--bg-light); background:var(--bg-light); color:var(--text-dark); --card-bg: #fff; }
    .light-mode .page{color:var(--text-dark);}
    .light-mode .btn { color:var(--text-dark); background:linear-gradient(90deg,#ffd6e6,#fff6f8); box-shadow:0 8px 16px rgba(0,0,0,.06)}
    .light-mode h1.main{color:var(--text-dark); text-shadow:none}

    /* cake styles */
    .cake-wrap{display:flex; flex-direction:column; align-items:center; gap:14px}
    .cake{
      width:260px; height:190px; position:relative; border-radius:12px; overflow:visible;
      transform-origin:center bottom;
    }
    .cake .layer{position:absolute; left:50%; transform:translateX(-50%); width:220px; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,.2);}
    .cake .layer.bottom{bottom:0; height:80px; background:linear-gradient(180deg,#ffd7e4,#ffb3c9); width:240px;}
    .cake .layer.middle{bottom:60px; height:60px; background:linear-gradient(180deg,#ffe7f1,#ffd0e4); width:220px}
    .cake .layer.top{bottom:110px; height:40px; background:linear-gradient(180deg,#fff0f6,#ffd7e4); width:180px}
    .cake .icing{position:absolute; left:50%; transform:translateX(-50%); top:80px; width:200px; height:40px; border-radius:20px; background:linear-gradient(90deg,#ff6b9a,#ff9cb1); box-shadow: inset 0 -6px 14px rgba(0,0,0,.06);}
    .candle{position:absolute; left:50%; top:18px; transform:translateX(-50%); width:8px; height:36px; background:#fff3; border-radius:3px;}
    .flame{position:absolute; left:50%; transform:translateX(-50%); top:-10px; width:14px; height:18px; background:radial-gradient(circle at 40% 30%, #fff1 0%, #ffd66b 20%, #ff8a00 60%, transparent 80%); clip-path:ellipse(40% 60% at 50% 40%); animation:flicker .12s infinite alternate;}
    @keyframes flicker{from{transform:translateX(-50%) scale(1)} to{transform:translateX(-50%) scale(.96) translateY(1px)}}

    /* confetti canvas */
    #confettiCanvas{position:absolute; inset:0; pointer-events:none; z-index:9999; display:block;}

    /* small responsive */
    @media (max-width:600px){
      .cake{width:200px;height:150px}
      .cake .layer.bottom{width:200px}
      .cake .layer.middle{width:180px}
      .cake .layer.top{width:150px}
    }

    /* final signature */
    .sign{margin-top:18px; font-weight:600; color:var(--soft); font-size:16px; text-shadow:0 4px 18px rgba(255,107,154,.12)}
    .hidden{display:none !important}
  </style>
</head>
<body>

<div class="wrap" id="app">

  <!-- decorative layers -->
  <div class="bg-layer" aria-hidden="true">
    <!-- stars (will be populated by JS) -->
  </div>

  <div class="hearts" id="hearts"></div>

  <!-- pages -->
  <!-- Page 1 -->
  <section class="page active" id="page1" style="z-index:5;">
    <h1 class="main">It‚Äôs your special day, my love üíñ</h1>
    <p class="lead">Komal, every moment with you is a poem ‚Äî today I celebrate you, your smile, your laughter and the beautiful heart you give to the world.</p>
    <div><small style="opacity:.7">Hold tight ‚Äî something sweet is coming ‚ú®</small></div>
  </section>

  <!-- Page 2 -->
  <section class="page" id="page2" style="z-index:5;">
    <h1 class="main">For the girl who brightens my every day</h1>
    <p class="lead">You make ordinary moments shine ‚Äî thank you for being you. I hope this little surprise makes you smile like you make me smile.</p>
  </section>

  <!-- Page 3 -->
  <section class="page" id="page3" style="z-index:5;">
    <h1 class="main">Do you wanna see what I made for you?</h1>
    <p class="lead">I worked on something special ‚Äî click to reveal üí´</p>
    <div style="display:flex; gap:12px; margin-top:12px;">
      <button class="btn" id="yesBtn">Yes üòç</button>
      <button class="btn secondary" id="noBtn">No üòú</button>
    </div>
    <div id="noMsg" style="margin-top:10px; color:#fff8; display:none;">Aree come on! Just click Yes üòÖ</div>
  </section>

  <!-- Page 4: Happy Birthday + photo bg -->
  <section class="page" id="page4" style="z-index:5;">
    <div class="photo-bg" id="photoBg" aria-hidden="true"></div>
    <h1 class="main"><span id="typedText" class="type"></span></h1>
    <p class="lead" id="subtitle">üéâ Happy Birthday Komal! üéÇüíñ</p>
  </section>

  <!-- Page 5: Light on -->
  <section class="page" id="page5" style="z-index:5;">
    <h1 class="main">Let's bring some light to your day!</h1>
    <p class="lead">The world looks beautiful in both dark and bright ‚Äî try the light switch üí°</p>
    <button class="btn" id="lightBtn">Light On üí°</button>
  </section>

  <!-- Page 6: Play music -->
  <section class="page" id="page6" style="z-index:5;">
    <h1 class="main">Now let's make it musical üéµ</h1>
    <p class="lead">A song for you ‚Äî press play and let it flow.</p>
    <button class="btn" id="playBtn">Play Music ‚ñ∂Ô∏è</button>
  </section>

  <!-- Page 7: Cake cutting -->
  <section class="page" id="page7" style="z-index:5;">
    <div class="cake-wrap">
      <h1 class="main">Time to cut the cake! üéÇ</h1>

      <!-- Cake -->
      <div class="cake" id="cake">
        <div class="layer bottom"></div>
        <div class="layer middle"></div>
        <div class="layer top"></div>
        <div class="icing"></div>
        <div class="candle">
          <div class="flame"></div>
        </div>
      </div>

      <div style="display:flex; gap:12px;">
        <button class="btn" id="cutBtn">Cut Cake üéâ</button>
        <button class="btn secondary" id="resetCake" style="display:none;">Reset</button>
      </div>

      <div id="postMsg" style="margin-top:12px; opacity:.95; display:none;">
        <h2 style="font-family:'Dancing Script',cursive; font-size:clamp(20px,5vw,36px)">Wish you the happiest birthday, my love üíï</h2>
        <div class="sign">‚Äî From Mayank</div>
      </div>

    </div>
  </section>

  <canvas id="confettiCanvas"></canvas>

</div>

<!-- Hidden audio element (provide your own file named music.mp3) -->
<audio id="bgAudio" src="birthday.mp3" preload="auto"></audio>

<script>
  // ====== Config ======
  const AUTO_DELAY = 6500; // 6.5 seconds between auto pages
  const AUTO_DELAY_SHORT = 3000; // 3 seconds (for No click)
  const pages = ['page1','page2','page3','page4','page5','page6','page7'];
  let currentIndex = 0;
  let autoTimer = null;
  const app = document.getElementById('app');

  // ====== helper to show page ======
  function showPage(idx){
    currentIndex = idx;
    pages.forEach((id,i)=>{
      const el = document.getElementById(id);
      if(i===idx) el.classList.add('active'); else el.classList.remove('active');
    });
    // special actions on entering pages
    if(pages[idx]==='page4') startTyping();
    if(pages[idx]==='page6') { /* nothing, wait for play */ }
    if(pages[idx]==='page7') { /* cake ready */ }
    // schedule auto next except certain pages (3 & 6 & 7 wait for interaction)
    clearTimeout(autoTimer);
    if(!['page3','page6','page7'].includes(pages[idx])){
      autoTimer = setTimeout(()=> { if(idx < pages.length-1) showPage(idx+1); }, AUTO_DELAY);
    }
  }

  // initial heart + star decorations
  function randomBetween(a,b){return a + Math.random()*(b-a);}
  // create stars
  const bgLayer = document.querySelector('.bg-layer');
  for(let i=0;i<40;i++){
    const s = document.createElement('div');
    s.className='star';
    s.style.left = Math.random()*100+'%';
    s.style.top = Math.random()*100+'%';
    s.style.width = (Math.random()*2+1)+'px';
    s.style.height = s.style.width;
    s.style.animationDelay = (Math.random()*4)+'s';
    bgLayer.appendChild(s);
  }
  // create hearts
  const heartsContainer = document.getElementById('hearts');
  for(let i=0;i<14;i++){
    const h = document.createElement('div');
    h.className='heart';
    h.style.left = (Math.random()*100)+'%';
    h.style.bottom = (-Math.random()*20 - 10)+'px';
    h.style.animationDuration = (randomBetween(8,14))+'s';
    h.style.opacity = Math.random()*0.9 + 0.2;
    h.style.transform = `translateY(120vh) scale(${randomBetween(.6,1.1)})`;
    heartsContainer.appendChild(h);
  }

  // ====== Page 3 buttons ======
  document.getElementById('yesBtn').addEventListener('click', ()=>{
    showPage(3); // page4 index is 3
    // auto advance to page5
    setTimeout(()=> showPage(4), AUTO_DELAY);
  });
  document.getElementById('noBtn').addEventListener('click', ()=>{
    const noMsg = document.getElementById('noMsg');
    noMsg.style.display='block';
    setTimeout(()=> { noMsg.style.display='none'; showPage(3); setTimeout(()=> showPage(4), AUTO_DELAY); }, AUTO_DELAY_SHORT);
  });

  // ====== Page 4 typing + photo bg ======
  // Put your Komal photo filename here (change if needed)
  const photoFile = 'komal.jpg';
  const photoBg = document.getElementById('photoBg');
  photoBg.style.backgroundImage = `url('${photoFile}')`;

  let fullText = "üéâ Happy Birthday Komal! üéÇüíñ";
  let typedIndex = 0;
  function startTyping(){
    typedIndex = 0;
    const el = document.getElementById('typedText');
    el.textContent = '';
    el.style.borderRight='2px solid rgba(255,255,255,.85)';
    const t = setInterval(()=> {
      typedIndex++;
      el.textContent = fullText.slice(0,typedIndex);
      if(typedIndex >= fullText.length){
        clearInterval(t);
        el.style.borderRight='none';
        // after a pause, auto next
        setTimeout(()=> showPage(4), AUTO_DELAY);
      }
    }, 70);
  }

  // ====== Light on toggle (page5) ======
  const lightBtn = document.getElementById('lightBtn');
  let lightOn=false;
  lightBtn.addEventListener('click', ()=>{
    lightOn = !lightOn;
    if(lightOn){
      document.documentElement.style.setProperty('--bg-dark', '#fff'); // optional
      document.body.classList.add('light-mode');
      // subtle change: invert star color
      document.querySelectorAll('.star').forEach(s=> s.style.background='rgba(0,0,0,.5)');
      lightBtn.textContent='Dark Mode üåô';
    } else {
      document.body.classList.remove('light-mode');
      document.querySelectorAll('.star').forEach(s=> s.style.background='rgba(255,255,255,.9)');
      lightBtn.textContent='Light On üí°';
    }
    // move next automatically
    setTimeout(()=> showPage(5), 900);
  });

  // ====== Music (page6) ======
  const audio = document.getElementById('bgAudio');
  const playBtn = document.getElementById('playBtn');
  playBtn.addEventListener('click', async ()=>{
    try{
      await audio.play();
      // show playing state
      playBtn.textContent='Playing üéµ';
      playBtn.disabled = true;
      // auto move forward after 4 seconds
      setTimeout(()=> showPage(6), 4000);
    }catch(e){
      alert('Browser blocked autoplay. Click Play again or allow audio ‚Äî modern browsers require a user gesture.');
    }
  });

  // ====== Cake cutting (page7) ======
  const cake = document.getElementById('cake');
  const cutBtn = document.getElementById('cutBtn');
  const resetBtn = document.getElementById('resetCake');
  const postMsg = document.getElementById('postMsg');

  let cutDone = false;
  cutBtn.addEventListener('click', ()=> {
    if(cutDone) return;
    cutDone = true;
    // animate a "slice" by shrinking right side with transform
    cake.style.transition = 'transform .9s ease';
    cake.style.transform = 'scale(.98) translateX(-12px) rotate(-1deg)';
    // create slice animation: we add an overlay that moves away
    const slice = document.createElement('div');
    slice.style.position='absolute';
    slice.style.left='55%';
    slice.style.bottom='0';
    slice.style.width='46%';
    slice.style.height='100%';
    slice.style.background='linear-gradient(180deg,#ffd7e4,#ffb3c9)';
    slice.style.borderRadius='12px';
    slice.style.transformOrigin='left center';
    slice.style.transition='transform .9s ease, opacity .9s ease';
    cake.appendChild(slice);
    setTimeout(()=> {
      slice.style.transform = 'translateX(160px) rotate(12deg)';
      slice.style.opacity = '0';
      cake.style.transform = 'scale(.98) translateX(-6px) rotate(-1deg)';
    }, 120);

    // candle blow out
    const flame = cake.querySelector('.flame');
    if(flame) flame.style.opacity = '0';

    // confetti
    runConfetti();

    // after confetti, show final message
    setTimeout(()=> {
      postMsg.style.display='block';
      resetBtn.style.display='inline-block';
    }, 1400);
  });

  resetBtn.addEventListener('click', ()=> location.reload());

  // ====== Confetti simple implementation ======
  const confCanvas = document.getElementById('confettiCanvas');
  confCanvas.width = innerWidth; confCanvas.height = innerHeight;
  const ctx = confCanvas.getContext('2d');
  let confettiParticles = [];

  function rand(min,max){return Math.random()*(max-min)+min;}
  function runConfetti(){
    confettiParticles = [];
    for(let i=0;i<150;i++){
      confettiParticles.push({
        x: rand(0,confCanvas.width),
        y: rand(-confCanvas.height,0),
        w: rand(6,12),
        h: rand(8,18),
        color: `hsl(${Math.floor(rand(0,360))},80%,60%)`,
        tilt: rand(-0.2,0.2),
        vy: rand(2,6),
        vx: rand(-2,2),
        rot: rand(0,Math.PI*2),
        rSpeed: rand(-0.08,0.08),
      });
    }
    confettiLoop();
    // stop after 3.5s
    setTimeout(()=> confettiParticles = [], 3500);
  }
  let confettiAnim;
  function confettiLoop(){
    cancelAnimationFrame(confettiAnim);
    ctx.clearRect(0,0,confCanvas.width,confCanvas.height);
    for(let p of confettiParticles){
      p.x += p.vx;
      p.y += p.vy;
      p.rot += p.rSpeed;
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
      ctx.restore();
    }
    confettiAnim = requestAnimationFrame(confettiLoop);
  }
  // resize canvas on window resize
  window.addEventListener('resize', ()=> {
    confCanvas.width = innerWidth; confCanvas.height = innerHeight;
  });

  // ====== Auto start: show page1 then schedule auto transitions ======
  // Show page1 is already active; schedule move to page2 after AUTO_DELAY
  setTimeout(()=> showPage(1), AUTO_DELAY);

  // accessibility: pause everything when page hidden
  document.addEventListener('visibilitychange', ()=> {
    if(document.hidden){ audio.pause(); }
  });

  // Prevent accidental navigation on mobile swipe zoom weirdness
  // (no-op but leaves UX smooth)
</script>

</body>
</html>